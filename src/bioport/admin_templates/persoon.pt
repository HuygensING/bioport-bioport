<html metal:use-macro="context/@@admin_template/macros/master">
<div metal:fill-slot="content"
	class="person_edit"
    tal:define="
    	merged_bio view/merged_biography;
    	bioport_bio view/bioport_biography; 
    	" 
    >
<h1>Bewerk gegevens van <em tal:content="python:view.person.naam().volledige_naam()" /></h1>
De gegevens in het formulier zijn de gegevens zoals ze op het biografisch portaal worden 
<a tal:attributes="href python:view.url(context.__parent__, 'persoon', data={'bioport_id':view.bioport_id})">getoond</a>. 

De gegevens zijn grijs als ze uit de bronnen-publikaties komen, zwart als ze zijn ingevoerd door de medewerkers van het biografisch portaal.


<form action="." tal:attributes="action request/URL" method="get"
      class="edit-form" enctype="multipart/form-data">
      <input type="hidden" name="bioport_id" tal:attributes="value python:view.bioport_id" />
      <p>
<table>
    <tr>
        <th>bioport identifier</th>
        <td tal:content="view/person/get_bioport_id" />
    </tr>
    <tr tal:define="namen view/get_bioport_namen"
    	tal:repeat="idx python:range(len(namen))">
    	<th><span tal:condition="python:idx == 0" >namen</span></th>
    	<td tal:define="naam python:namen[idx]"
    		tal:content="naam/volledige_naam" />
		<td>
			<a tal:attributes="href python:view.url('changename', data={'bioport_id':view.bioport_id, 'idx':idx})">
			verander
			</a>
		</td>    	
   	</tr>
   	<tr>
   		<td>
   		</td>
   		<td>
	    </td>
    <tr tal:repeat="naam view/get_non_bioport_namen">
    	<th></th>
    	<td class="merged"
    		tal:content="naam/volledige_naam" />
   	</tr>
   	<tr>
	<td></td>
	<td></td>
	<td>
		<a tal:attributes="href python:view.url('changename', data={'bioport_id':view.bioport_id, 'idex':'new'})">
		voeg een naam toe
		</a>
	</td>    	
    </tr>
    
    <!-- geboortedatum -->
    <tr> 
        <th>geboortedatum</th>
        <td tal:define="ymd  python:view.get_value('geboortedatum')"
        	tal:attributes="class python:view.status_value('geboortedatum')">
        	<select name="birth_d">
        		<option />
        		<option 
	        		tal:repeat="option python:range(1, 32)" 
	        		tal:attributes="selected python:ymd[2] == option"
	        		tal:content="option"
        		/>
        	</select>
        	<select name="birth_m">
        		<option>
        		<option 
	        		tal:repeat="option python:range(1, 32)" 
	        		tal:attributes="selected python:ymd[1] == option"
	        		tal:content="option"
        		/>
        	</select>
        	<input name="birth_y" type="text" size="4" style="width:4"
        		tal:attributes="value python:ymd[0]" />
        	
        </td>
        <td>
        <span tal:replace="structure python:view.actions.byname['form.actions.save_geboortedatum'].render()" />
        </td>
    </tr>
    
    <!--  geboorteplaats -->
     <tr> 
        <th>geboorteplaats</th>
        <td tal:attributes="class python:view.status_value('geboorteplaats')">
        	<input type="tekst" name="geboorteplaats"
        	tal:attributes="value python:view.get_value('geboorteplaats')" />
        </td>
        <td>
	        <span tal:replace="structure python:view.actions.byname['form.actions.save_geboorteplaats'].render()" />
        </td>
    </tr>
    
    <!-- sterfdatum -->
    <tr> 
        <th>sterfdatum</th>
        <td tal:define="ymd  python:view.get_value('sterfdatum')"
        	tal:attributes="class python:view.status_value('sterfdatum')">
        	<select name="death_d">
        		<option />
        		<option 
	        		tal:repeat="option python:range(1, 32)" 
	        		tal:attributes="selected python:ymd[2] == option"
	        		tal:content="option"
        		/>
        	</select>
        	<select name="death_m">
        		<option>
        		<option 
	        		tal:repeat="option python:range(1, 32)" 
	        		tal:attributes="selected python:ymd[1] == option"
	        		tal:content="option"
        		/>
        	</select>
        	<input name="death_y" type="text" size="4" style="width:4"
        		tal:attributes="value python:ymd[0]" />
        	
        </td>
        <td>
        <tt tal:replace="structure python:view.actions.byname['form.actions.save_sterfdatum'].render()" />
        </td>
    </tr>
    
    <!--  sterfplaats -->
     <tr> 
        <th>sterfplaats</th>
        <td tal:attributes="class python:view.status_value('sterfplaats')">
        	<input type="tekst" name="sterfplaats"
        	tal:attributes="value python:view.get_value('sterfplaats')" />
        </td>
        <td>
	        <span tal:replace="structure python:view.actions.byname['form.actions.save_sterfplaats'].render()" />
        </td>
    </tr>
    <tr>
   	<th />
   	<td>
        <span tal:replace="structure python:view.actions.byname['form.actions.save_everything'].render()" />
	</td> 
	        
    </tr>
</table>
</form>
<h2>Acties</h2>
<ul>
<li>
<a href="" class="todo" onclick="alert('nog niet geimplementeerd')">Bekijk bewerk-geschiedenis</a>
<li>
<a href="" onclick="alert('nog niet geimplementeerd')">Zoek naar andere biografie&euml;n van deze persoon</a>
</ul>

<div class="info">
<h1>Tekst</h1>
	<div  
		tal:define="tekst python:merged_bio.get_value('tekst')"
		>
		<span tal:condition="not:tekst">Van deze biografie heeft het portaal niet de tekst beschikbaar</span>
		<span	tal:replace="structure tekst"> </span>
		<a tal:condition="tekst" href="">[toon volledige tekst]</a>
		<a tal:condition="tekst" href="">[bron]</a>
	</div>
	
<h1>Biografie&euml;n van deze persoon</h1>
<div tal:repeat="bio view/person/get_biographies">
<h2>Bron: 
		<span tal:replace="python:bio.get_source().id"></span> - <span tal:replace="python:bio.get_source().description"></span>
</h2>
<table>
	<tr>
		<th>Namen</th>
		<td>
			<div tal:repeat="naam python:bio.get_namen()" tal:content="naam/volledige_naam"></div>	
		</td>
	</tr>
	<tr>
		<th>Geboortedatum</th>
		<td>
			<span tal:replace="python:context.format_date(bio.get_value('geboortedatum'))" />
		</td>
	</tr>
	<tr>
		<th>Geboorteplaats</th>
		<td>
			<span tal:replace="python:bio.get_value('geboorteplaats')" />
		</td>
	</tr>
		<tr>
		<th>Sterfdatum</th>
		<td>
			<span tal:replace="python:context.format_date(bio.get_value('sterfdatum'))" />
		</td>
	</tr>
	<tr>
		<th>Sterfplaats</th>
		<td>
			<span tal:replace="python:bio.get_value('sterfplaats')" />
		</td>
	</tr>
	</table>
</div>
</div>
</div>
</html>
