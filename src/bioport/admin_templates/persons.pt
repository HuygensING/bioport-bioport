<html metal:use-macro="context/@@admin_template/macros/master">
<div metal:fill-slot="content" 
tal:define="batch view/get_persons">
		<h1>Persons</h1>
<span tal:repeat="letter string:abcdefghijklmnopqrstuvwxyz"
    tal:attributes="class python:letter == request.get('beginletter') and 'alfabet selected' or 'alfabet'"
    ><a tal:attributes="href python:view.url(view, data={'beginletter':letter, 'source_id':request.get('source_id', ''), 'status':request.get('status', '')})" ><span tal:replace="letter/upper" /></a></span>
<p>
<form tal:attributes="action view/url">
	<span tal:repeat="source python:view.repository().get_sources()"
		tal:condition="nothing"
	    tal:attributes="class python:source.id == request.get('source_id') and 'alfabet selected' or 'alfabet'"
	>
	    <a tal:attributes="href string:${view/url}?source_id=${source/id}" ><span tal:replace="source/id" /></a></span>
	    <span class="alfabet" tal:condition="nothing">
	    <a tal:attributes="href string:${view/url}?beginletter=%" >alle namen</a></span>
naam: <input type="text" name="search_term" tal:attributes="value request/search_term | nothing" />

bron:
<select name="source_id">
	<option>
	<option tal:repeat="source python:[s for s in view.get_sources() if s.id != 'bioport']" 
		tal:attributes="value source/id;
			selected python:source.id == request.get('source_id')"
		tal:content="python:source.id" />
</select>
<br>	
status : 
<select name="status">
	<option></option>
	<option tal:repeat="status view/get_status_values" 
	   tal:attributes="value python:status[0];
	       selected python:str(status[0]) == request.get('status')"
	   tal:content="python:status[1]">..</option>
</select>
<span tal:condition="nothing">
<br>	
levensjaren niet ingevuld <input type="checkbox" />
<br>	
</span>
	<input type="submit" value=" zoek " />
	<br>
</form>
<ul>
<li tal:condition="request/auteur_id | nothing">U zocht naar biografie&euml;n met <em tal:content="structure python:view.repository().get_author(request.form['auteur_id']).name"></em> als auteur.</li>
<li tal:condition="request/beroep_id | nothing">U zocht naar biografie&euml;n met <em tal:content="structure python:here.get_beroep(request.beroep_id).naam"></em> als beroep.</li>
</ul>

<div metal:use-macro="context/@@sitemacros/macros/aantal_resultaten" />
<div metal:use-macro="context/@@sitemacros/macros/batch_navigation" />

<table>
<tr>
    <th style="width:50%">Naam</th>
    <th>status</th>
    <th>bron</th>
    <th tal:condition="nothing">laatst bewerkt</th>
    <th tal:condition="nothing">verant- woordelijk</th>
    <th tal:condition="nothing">status</th>
</tr>
<tr tal:repeat="person python:batch">
	<td >
		<a 
	tal:content="structure python:person.naam() and person.naam().guess_normal_form() or 'XXXXX'" 
    tal:attributes="href python:view.url(context.__parent__, 'persoon', data={'bioport_id':person.get_bioport_id()})" />
    
    <span tal:replace="python:context.format_dates(person.get_merged_biography().geboortedatum(), person.get_merged_biography().sterfdatum())" />
	</td>
	<td>
        <span tal:replace="python:person.status and view.get_status_values(person.status)"	 />
	</td>
	<td>
	   <span tal:repeat="source python:person.get_sources()">
	   <Span
	       tal:condition="python:source.id != 'bioport'"
	       tal:content="source/id" />
	   </span>
	</td>
	<td tal:condition="person/get_bioport_id">
	    <a tal:attributes="href python:view.url(context,'persoon', data={'bioport_id':person.get_bioport_id()})">
	    	bewerk gegevens
	     </a>
	</td>
	<td tal:condition="nothing">
	TODO
	<span tal:replace="person/last_commit" />
		door <em class="todo">jelle</em>
		</td>
	<td tal:condition="nothing" class="todo">jelle</td>
	<td tal:condition="nothing">XXX</td>
	<td tal:condition="nothing">XXX (nog te doen, af, nog checken, ...)</td>
</tr>
<ul>
</div>
</html>
